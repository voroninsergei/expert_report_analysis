# Анализ судебной экспертизы с помощью Python и ChatGPT

Этот проект предоставляет утилиту на Python, которая принимает на вход файл экспертного заключения в формате **PDF** или **DOCX**, извлекает из него текст (включая распознавание изображений с помощью OCR), объединяет этот текст с заданным промтом для анализа судебной экспертизы и отправляет его в ChatGPT. Полученный ответ сохраняется в виде отчёта в формате **DOCX**.

## Возможности

* Загрузка экспертного заключения в форматах PDF и DOCX.
* Извлечение текста из документов, включая изображения, содержащие текст (OCR).
* Отправка извлечённого текста вместе с заранее определённым промтом в ChatGPT для получения детального анализа экспертизы.
* Формирование итогового отчёта в формате DOCX.

## Требования

* Python 3.9 или новее.
* Установленные зависимости из файла `requirements.txt`.
* Ключ API OpenAI. Его необходимо сохранить в переменной окружения `OPENAI_API_KEY`.

## Установка

1. Клонируйте репозиторий и перейдите в его каталог:

```bash
git clone <URL_вашего_репозитория>
cd expert_report_analysis
```

2. Создайте и активируйте виртуальное окружение (рекомендуется):

```bash
python3 -m venv .venv
source .venv/bin/activate
```

3. Установите зависимости:

```bash
pip install -r requirements.txt
```

4. Установите путь к OpenAI API ключу в переменной окружения `OPENAI_API_KEY`:

```bash
export OPENAI_API_KEY="ваш-секретный-ключ"
```

## Использование

```bash
python -m src.main --input path/to/expert_report.pdf --output path/to/result.docx
```

Опция `--prompt` позволяет указать свой собственный текстовый файл с промтом. Если она не задана, будет использоваться файл `prompt.txt` из корня проекта.

Пример:

```bash
python -m src.main \
    --input data/экспертиза.docx \
    --output results/отчёт.docx \
    --prompt custom_prompt.txt
```

## Структура проекта

- `prompt.txt` — файл с базовым промтом для проведения анализа судебной экспертизы.
- `requirements.txt` — список зависимостей проекта.
- `src/` — исходный код:
  - `extract.py` — функции для извлечения текста и изображений из PDF/DOCX.
  - `ocr.py` — функции для распознавания текста на изображениях.
  - `chatgpt.py` — работа с API ChatGPT.
  - `report.py` — генерация итогового отчёта в DOCX.
  - `main.py` — точка входа, связывающая все компоненты.

## Примечания

- OCR реализуется через библиотеку **pytesseract**, поэтому для корректной работы необходимо установить бинарные файлы *Tesseract OCR* в систему. На Linux это можно сделать, например, через пакетный менеджер `apt`:

  ```bash
  sudo apt install tesseract-ocr
  ```

- В примере промта используется русскоязычная инструкция для команды AI‑специалистов, исходная версия промта содержится в файле `prompt.txt`.

## Лицензия

Данный проект распространяется под лицензией MIT.
